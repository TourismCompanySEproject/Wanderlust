{%  extends 'trips/base.html' %}
<title>{% block title %}Trip Details{% endblock %}</title>

{% load humanize %}
{% load static %}

 {% block stylesheet %}
  <link rel="stylesheet" href="{% static 'css/simplemde.min.css' %}">
  <script src="{% static 'js/simplemde.min.js' %}"></script>
  <script>
    var simplemde = new SimpleMDE();
  </script>

 {% endblock %}

{%  block body %}
    <!-- Trip Details -->
        <div >
                <div class="col-sm-4 col-lg-12">
                    <div class="thumbnail" style="width: 700px ; height: 600px; margin: auto;  ">

                     <h1>{{ trip.name }}</h1>

                        <img style="width: 600px ; height: 250px;" src="{{ trip.trip_image1.url }}" class="img-responsive">

                     <p>from: {{ trip.origin  }} - to: {{ trip.destination  }}</p>
                        <p>decription: {{ trip.description }} per</p>

                     <p>from: {{ trip.departing_date  }} - to: {{ trip.returning_date  }}</p>
                     <p>Type of transportation: {{ trip.get_transportstion_display }} </p>
                     <p>Type of residence: {{ trip.get_residence_display }} </p>
                     <p>Adult price: {{ trip.adult_price }} L.E</p>
                     <p>Kid price: {{ trip.adult_price }} L.E</p>

    </div>
        <!-- Admin contol -->
        {% if user.is_staff  %}
        <div class="thumbnail" style="width: 700px ; height: 80px; margin: auto; padding-bottom: 45px;>
            <!-- Delete Trip -->

            <form action="{% url 'trips:delete_trip' trip.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <input type="hidden" name="trip_id" value="{{ trip.id }}" />
                <button style="width: 350px ; height: 30px;" type="submit" class="btn btn-danger">
                    <span class="glyphicon glyphicon-trash"></span>&nbsp; Delete
                </button>
            </form>

            <!-- Update Trip -->
            <a href="{% url 'trips:trip-update' trip.id %}" class="btn btn-info" role="button" style="width: 350px ; height: 30px;>
                <span class="glyphicon glyphicon-refresh"></span>&nbsp; Update
            </a>

            </div>
        {% endif %}
        <!-- User Bookin -->

            <form class="btn btn-default btn-sm" role="" method="get" action="{% url 'trips:book' trip.id %}">
                <button type="submit" class="glyphicon glyphicon-book">Book</button>
            </form>

        <!-- User Questions -->
<div>

{% for question in trip.question_set.all %}
    {% if question.reply_to is not 0 %}
    <div class="card mb-2">
      <div class="card-body p-3">
        <div class="row mb-3">
          <div class="col-6">
            <strong class="text-muted">{{ question.asked_by }}</strong>
          </div>
          <div class="col-6 text-right">
            <small class="text-muted">{{ question.asked_at|naturaltime  }}</small>
          </div>
        </div>
        {{ question.get_message_as_markdown }}
      <div>
          <div>
              {% for re_question in question.question_set.all %}
                <div class="card mb-2">
                  <div class="card-body p-3">
                    <div class="row mb-3">
                      <div class="col-6">
                        <strong class="text-muted">{{ re_question.asked_by }}</strong>
                      </div>
                      <div class="col-6 text-right">
                        <small class="text-muted">{{ re_question.asked_at|naturaltime  }}</small>
                      </div>
                    </div>
                    {{ re_question.get_message_as_markdown }}

                  </div>
                </div>
          </div>
               {% endfor %}
         <div>
               <form class="" role="" method="post" action="{% url 'trips:reply_question' trip.id question.id %}">
                {% csrf_token %}
                <div class="form-group">
                    <input class=""  name="c" type="text" value="{{ request.POST.c }}" placeholder="Your comment..."/>
                </div>
                <button type="submit" class="btn btn-success">&nbsp;reply</button>
               </form>

          </div>
      </div>
    </div>
    </div>
    {% endif %}
  {% endfor %}

<div>
{#      <a href="{% url 'trips:new_question' trip.id %}"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>&nbsp; add comment </a>#}
    <form class="" role="" method="post" action="{% url 'trips:new_question' trip.id %}">
        {% csrf_token %}
        <div class="form-group">
            <input class=""  name="c" type="text" value="{{ request.POST.c }}" placeholder="Your comment..."/>
        </div>
                <button type="submit" class="btn btn-success">&nbsp;add comment</button>
    </form>




                    </div>
</div>
        </div>
{%  endblock %}